<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­ØµØµ Ø§Ù„Ù…ØªØ·ÙˆØ±</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <style>
    body { font-family: Arial; background: #f0f0f0; padding: 20px; }
    .form-container { background: #fff; padding: 20px; border-radius: 8px; max-width: 450px; margin: auto; }
    input, select, button { width: 100%; padding: 8px; margin: 6px 0; border-radius: 4px; border: 1px solid #ccc; }
    button { cursor: pointer; }
    .btn-add { background: #007bff; color: white; }
    .btn-add:hover { background: #0056b3; }
    .btn-edit { background: #ffc107; color: white; }
    .btn-edit:hover { background: #e0a800; }
    .btn-delete { background: #dc3545; color: white; }
    .btn-delete:hover { background: #c82333; }
    ul { max-width: 600px; margin: 20px auto; padding: 0; list-style: none; }
    li { background: #fff; margin-bottom: 6px; padding: 10px; border-radius: 4px; border: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; }
    .actions button { margin-left: 5px; }
  </style>
</head>
<body>

  <div class="form-container">
    <h2>Ø¥Ø¯Ø§Ø±Ø© Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­ØµØµ</h2>
    <input type="text" id="teacherName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³">
    <input type="text" id="subject" placeholder="Ø§Ù„Ù…Ø§Ø¯Ø©">
    <input type="text" id="className" placeholder="Ø§Ù„ØµÙ / Ø§Ù„Ø´Ø¹Ø¨Ø©">
    <select id="day">
      <option>Ø§Ù„Ø£Ø­Ø¯</option>
      <option>Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†</option>
      <option>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option>
      <option>Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option>
      <option>Ø§Ù„Ø®Ù…ÙŠØ³</option>
    </select>
    <input type="time" id="startTime">
    <input type="time" id="endTime">
    <button class="btn-add" onclick="addOrUpdateSchedule()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­ØµØ©</button>
  </div>

  <h3 style="text-align:center;">Ø§Ù„Ø­ØµØµ Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h3>
  <ul id="scheduleList"></ul>

  <script>
    // ğŸ‘‡ Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let editId = null; // Ù„ØªØ®Ø²ÙŠÙ† id Ø§Ù„Ø­ØµØ© Ø¹Ù†Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„

    // Ø¥Ø¶Ø§ÙØ© / ØªØ¹Ø¯ÙŠÙ„ Ø­ØµØ©
    function addOrUpdateSchedule() {
      const teacherName = document.getElementById("teacherName").value.trim();
      const subject = document.getElementById("subject").value.trim();
      const className = document.getElementById("className").value.trim();
      const day = document.getElementById("day").value;
      const startTime = document.getElementById("startTime").value;
      const endTime = document.getElementById("endTime").value;

      if (!teacherName || !subject || !className || !startTime || !endTime) {
        return alert("Ø§ÙƒÙ…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
      }

      const data = { teacherName, subject, className, day, startTime, endTime, createdAt: new Date() };

      if (editId) {
        // ØªØ¹Ø¯ÙŠÙ„
        db.collection("sessionsSchedule").doc(editId).set(data)
          .then(() => {
            alert("âœ… ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­ØµØ©!");
            editId = null;
            clearForm();
            fetchSchedules();
          })
          .catch(err => alert("âŒ Ø®Ø·Ø£: " + err));
      } else {
        // Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙŠØ¯Ø©
        db.collection("sessionsSchedule").add(data)
          .then(() => {
            alert("âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­ØµØ©!");
            clearForm();
            fetchSchedules();
          })
          .catch(err => alert("âŒ Ø®Ø·Ø£: " + err));
      }
    }

    function clearForm() {
      document.getElementById("teacherName").value = "";
      document.getElementById("subject").value = "";
      document.getElementById("className").value = "";
      document.getElementById("startTime").value = "";
      document.getElementById("endTime").value = "";
      document.querySelector(".btn-add").textContent = "Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­ØµØ©";
    }

    // Ø¬Ù„Ø¨ Ø§Ù„Ø­ØµØµ ÙˆØ¹Ø±Ø¶Ù‡Ø§
    function fetchSchedules() {
      const list = document.getElementById("scheduleList");
      list.innerHTML = "";
      db.collection("sessionsSchedule").orderBy("createdAt").get().then((snapshot) => {
        snapshot.forEach(doc => {
          const s = doc.data();
          const li = document.createElement("li");

          li.innerHTML = `
            <span>${s.subject} - ${s.className} - ${s.day} (${s.startTime} - ${s.endTime}) - Ø§Ù„Ù…Ø¯Ø±Ø³: ${s.teacherName}</span>
            <span class="actions">
              <button class="btn-edit" onclick="editSchedule('${doc.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
              <button class="btn-delete" onclick="deleteSchedule('${doc.id}')">Ø­Ø°Ù</button>
            </span>
          `;
          list.appendChild(li);
        });
      });
    }

    // Ø­Ø°Ù Ø§Ù„Ø­ØµØ©
    function deleteSchedule(id) {
      if (!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø­ØµØ©ØŸ")) return;
      db.collection("sessionsSchedule").doc(id).delete()
        .then(() => fetchSchedules())
        .catch(err => alert("âŒ Ø®Ø·Ø£: " + err));
    }

    // ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­ØµØ©
    function editSchedule(id) {
      db.collection("sessionsSchedule").doc(id).get().then(doc => {
        const s = doc.data();
        document.getElementById("teacherName").value = s.teacherName;
        document.getElementById("subject").value = s.subject;
        document.getElementById("className").value = s.className;
        document.getElementById("day").value = s.day;
        document.getElementById("startTime").value = s.startTime;
        document.getElementById("endTime").value = s.endTime;
        editId = id;
        document.querySelector(".btn-add").textContent = "Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„";
      });
    }

    fetchSchedules();
  </script>

</body>
</html>
